# 人脸表情识别

[在线 Demo 地址](https://huoyijie.cn:1024/face-ai/)

一般学术论文中对表情的分类有7到8种:

+ Anger (愤怒)
+ Contempt (蔑视)
+ Disgust (厌烦)
+ Fear (恐惧)
+ Happiness (高兴)
+ Neutral (平静)
+ Sadness (悲伤)
+ Surprise (惊讶)

如下图：模型输入是一张图片，输出是检测到的表情及其概率

![demo](https://cdn.huoyijie.cn/uploads/2024/03/demo.png)

## 模型算法

主要涉及2种基于神经网络的算法
1. 人脸检测算法
2. 表情识别算法

## Demo中算法采用的数据集 AffectNet

AffectNet 数据集包含超过 100 万张图像，每张图像都标注了相应的情绪类别

![affectnet](https://cdn.huoyijie.cn/uploads/2024/03/affectnet.png)

另一个常用的数据集是 Fer2013，由 48*48 像素灰度人脸图片组成，(0=Angry, 1=Disgust, 2=Fear, 3=Happy, 4=Sad, 5=Surprise, 6=Neutral)，训练集有 28,709张图片，测试集合有 3,589 张图片。

## 模型检测流程

+ 预处理:

输入图片，检测照片中的人脸，并输出人脸左上角、右下角坐标。

+ 表情识别模型推理

通过图片处理，把人脸截取出来，并输入到表情识别模型，得出概率化表情分析

+ 后处理

把模型输出数据转换为概率并对应上截取的人脸

## 程序

主要分几块:
1. 编写模型程序本身+训练模型参数
2. 编写预处理、后处理、界面程序
3. 数据集图片标注方法和程序，医院提供图片，但是需要有专有程序配合完成数据标注
4. 编写其他所需配合性程序

## 训练

### 实验不同的神经网络模型

因为需要在医院特有数据集上训练，识别分类也可能不同，需要重现搭建模型，并反复训练模型参数、调整/更换模型、优化预处理及后处理程序

### 实验环境准备

租用云服务器(GPU)、搭建环境等预算，可根据实际情况计算。
![gpu](https://cdn.huoyijie.cn/uploads/2024/03/gpu.png)

### 数据集准备(训练数据+验证数据)

+ 数据多样性: 数据集中的图像应涵盖各种医院场景和情况，以确保模型在不同环境下的表现稳健。如果需要模型能够识别各种表情，还需要涵盖各种表情，例如高兴、悲伤、焦虑等。

+ 表情类别数量: 训练模型识别的表情类别数量会影响所需的标注图像数量。通常来说，类别越多，需要的样本数量也越多，以确保模型能够学习到每种表情的特征。

+ 数据质量: 图像的质量对模型的性能有着重要影响。标注图像应该是清晰、高分辨率的，并且包含目标人脸的正确标注。低质量或不正确标注的图像可能会降低模型的性能。

## 问题

+ 需和医院这边确定好表情分类
+ 需按要求提供高质量人工标注图片数据集，数量可能至少数万张，具体数据标注格式和标注方法还需要再确定
+ 模型需要重新搭建和训练，经过医院专有数据训练后，效果也不确定，高度取决于数据集的质量
