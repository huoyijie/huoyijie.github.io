# 搭建配置邮件服务器

现在的邮箱服务商提供了很好的服务，用户可以几乎无空间限制的随时随地的收发邮件，企业用户可以付费使用高阶功能。作为用户不用关心邮件服务器怎么搭建、配置，有没有收到和转发垃圾邮件，是否中继邮件时被别的邮件服务商当垃圾邮件拒收了，也不需要关注邮件服务器的性能监控、数据备份、安全和空间等等很多问题。

与之相比，自己维护一个邮件服务器是一件挺费劲的事情，但是好处是，邮件数据完全自己可控，也不用时刻担心数据泄漏，对于企业用户来说，很多重要的业务数据都在上面，虽然都声称是加密存储的，有没有偷偷读取用户邮件数据进行数据业务分析和反垃圾邮件模型训练等，估计哪个服务商也不敢完全打包票。

首先先介绍几个概念：
1. 发送邮件服务器: 负责邮件地址的解析以及邮件的路由和投递，实现 SMTP 等协议。如 [postfix](http://www.postfix.org/)、sendmail等
2. 接收邮件服务器: 负责邮件的存储以及配合 MUA 来取邮件，实现 POP、IMAP 等协议。如 [dovecot](https://www.dovecot.org/)
3. 邮件用户代理 Mail User Agent (MUA): 是一个用于收发邮件的应用程序。发邮件时把邮件交给发送邮件服务器，收邮件时，从接收邮件服务器下载邮件，如 foxmail、Thunderbird 等客户端软件。

用户通过客户端软件编辑邮件点发送，邮件首先会交给客户端软件本身配置的 SMTP 服务器，由后者进行解析和路由，经过多个邮件传输代理的转发，最终投递到目标邮件服务器。目标邮件服务器会存储邮件，并等到目标用户登录邮件客户端软件查收邮件时，会请求客户端软件配置的 IMAP/POP 收件服务器，此时邮件传输到用户的电脑或者手机上。